pipeline {
    agent any
    environment{
        SONARSERVER = 'sonar'
        SONARSCANNER = 'sonarscanner' 
    }
    stages {        
    stage('CODE ANALYSIS with SONARQUBE') {          
          environment {
             scannerHome = tool "${SONARSCANNER}"
          }
          steps {
            withSonarQubeEnv("${SONARSERVER}") {
               sh '''${scannerHome}/bin/sonar-scanner \
                   -Dsonar.login=admin \
                   -Dsonar.password=admin \
                   -Dsonar.sources=src/ \
                   -Dsonar.projectKey=duyna \
                   -D sonar.exclusions=vendor/**,resources/**,**/*.java \
                   -D sonar.host.url=http:http://54.159.46.23/
            }
          }
    }  
